<!DOCTYPE html>
<html>
<head>
    {% include 'accounts/base_style.html' %}

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <title>Tableau de Bord</title>
    <style type="text/css">

        .bordered {
            border: 1px solid #ddd;
        }
        .vertical-divider {
            border-right: 1px solid #ddd;
        }
        .horizontal-divider {
            border-bottom: 1px solid #ddd;
        }
    </style>
</head>
<body>

    <div class="container mt-4">
        <h2 class="mb-3">Bienvenue sur votre tableau de bord {{ user.username }} ! Vous avez {{ user.profile.credits }} crédits !</h2>
        <div class="d-flex justify-content-between mb-3">
            {% if user.profile.credits > 0 %}
                <a href="{% url 'upload_exercise' %}" class="btn btn-info">Demander la correction d'un exercice</a>
            {% else %}
                <button class="btn btn-danger" disabled>Pas assez de crédit pour déposer une demande</button>
            {% endif %}
            <a href="{% url 'personal_infos' %}" class="btn btn-info">Accès info persos</a>
            <i class="fas fa-bell fa-2x"></i>
            <form action="{% url 'logout' %}" method="post" class="form-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-info">Se déconnecter</button>
            </form>
           

        </div>

        <h3>Vos Exercices</h3>
        <div class="row mb-3 font-weight-bold">
            <div class="col-md-1 vertical-divider">Titre</div>
            <div class="col-md-3 vertical-divider">Texte</div>
            <div class="col-md-3 vertical-divider">Photo</div>
            <div class="col-md-2 vertical-divider">Date de création</div>
            <div class="col-md-1 vertical-divider">Correction</div>
            <div class="col-md-2">Action</div> <!-- Ajout d'une nouvelle colonne pour les actions -->
        </div>
        <div class="bordered">
            <ul class="list-unstyled">
                {% for exercise in exercises %}
                <li class="horizontal-divider">
                    <div class="row py-2">
                        <div class="col-md-1 vertical-divider">{{ exercise.title }}</div>
                        <div class="col-md-3 vertical-divider">{{ exercise.text }}</div>
                        <div class="col-md-3 vertical-divider">
                            <img src="{{ exercise.photo_statement.url }}" alt="Photo de l'énoncé" class="img-fluid">
                        </div>
                        <div class="col-md-2 vertical-divider">{{ exercise.submission_date|date:"d/m/Y à H:i" }}</div>
                        <div class="col-md-1 vertical-divider">{{ exercise.corrected|yesno:"Oui,Non" }}</div>
                        <div class="col-md-2">
                            <a href="{% url 'exercise_detail' exercise.id %}" class="btn btn-info">Accéder à l'Exercice</a>
                        </div> <!-- Ajout d'un bouton pour accéder à l'exercice -->
                    </div>
                </li>
                {% empty %}
                <li>Aucun exercice téléchargé.</li>
                {% endfor %}
            </ul>
        </div>
        
    </div>
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>